var c = document.getElementById('canvas');
var ctx = c.getContext('2d');

//var map1 = 'data:image/png;base64,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';

var testmap2 = 'data:image/png;base64,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';

var mapsrc = new Image();
mapsrc.src = testmap2;

var objects = [];

function mapToArray(){
  c.width = mapsrc.width;
  c.height = mapsrc.height;
  ctx.drawImage(mapsrc,0,0);
  var imgData = ctx.getImageData(0, 0, mapsrc.width, mapsrc.height);
  var scale = 25;

  var map =[];

  for (var y = 0; y < mapsrc.height; y++) {
    map.push([]);
    for (var x = 0; x < mapsrc.width; x++) {
      map[y].push(toHex(imgData.data[(y * mapsrc.width + x) * 4 + 0])+
                  toHex(imgData.data[(y * mapsrc.width + x) * 4 + 1])+
                  toHex(imgData.data[(y * mapsrc.width + x) * 4 + 2]));
    }
  }
  for(var y = 0; y<map.length; y++){
  	for(var x = 0; x<map[y].length; x++){
      switch (map[y][x]) {
        case '00ff00': //player
          objects.unshift(new player(x,y));
          break;
        case '000000': //wall
          objects.push(new wall(x,y));
          break;
        case '888888': //decoration
          objects.push(new decoration(x,y,'`'));
          break;
        default:break;
      }
    }
  }
}

function toHex(n){
  if(n.toString(16).length<2)
    return '0'+ n.toString(16);
  return n.toString(16);
}

mapToArray();

//var jsonData = JSON.stringify(data);

var code = 'var objects = '+JSON.stringify(objects)+';';

function download(text, name, type) {
    var a = document.createElement("a");
    var file = new Blob([text], {type: type});
    a.href = URL.createObjectURL(file);
    a.download = name;
    a.click();
}
download(code, 'test.js', 'text/javascript');
